# Rules / ルール（暫定）

本ドキュメントはゲームのルール本文（自然言語）であり、
実装およびテストプレイの基準となる。

* 数値・盤面定義は `data/` を正とする
* 用語定義は `docs/00_glossary.md` を正とする

---

## 1. ゲームの目的

プレイヤーは帝国経済圏を巡り、
資産・称号・実績・コレクションを構築する。

本ゲームには途中での「ゲームクリア」は存在しない。
**19世紀（Victorian）と21世紀（Modern）を往復する経済サイクルを3回実行した後、**
**最終21世紀における評価資産価値が最も高いプレイヤーが勝利する。**

---

## 2. 構成要素（概略）

* **Area（国家/地域エリア）**
  複数の Tile（マス）で構成される地理単位

* **Tile（マス）**
  停止・通過によって効果が発生する最小単位

* **Route（ルート）**
  Area / Tile 間の移動経路
  封鎖・開通・片道制限などの状態を持つ

* **Event Card（イベントカード）**
  引いた瞬間、または条件達成時に効果が発生する

* **Asset（資産）**

  * 可換資産（Fungible）：金貨・銀貨・銅貨・紙幣・地金・アイテム 等
  * 非可換資産（Non-Fungible）：金貨（個体）・称号・鉱山権・契約 等

* **Era（時代）**

  * Victorian（19世紀）
  * Modern（21世紀）

時代によって、使用可能なルール・デッキ・評価軸が変化する。

---

## 3. ゲームの流れ（ターン構造：暫定）

ターンは以下のフェーズで進行する。

### 1) Start of Turn

* 継続効果（期限付き Permission / ペナルティ）を処理する

### 2) Action Selection

* プレイヤーは行動を選択する
* 初期状態では「移動」が基本行動となる
* 行動の可否は Permission および Ruleset により判定される

### 3) Movement Resolution

* 選択した移動を解決する
* Route の封鎖状態、必要条件（称号等）、コストを判定する
* 移動先 Tile が確定したらプレイヤー位置を更新する

### 4) Tile Resolution

* 移動先 Tile の効果を解決する
* 効果は `on_enter` / `on_stop` などで定義される

### 5) Card Resolution（該当時）

* マス・効果によりカードを引いた場合、カード効果を解決する

### 6) End of Turn

* ターン終了処理
* 期限切れ Permission の削除
* ログ・履歴の記録

※ 同時発火する効果は EventQueue に積み、順序通りに解決する。

---

## 4. 移動（概念）

* 盤面は Graph（ノードとエッジ）で表現される
* ノードは Tile を参照する
* エッジ（Route）は移動手段を持つ

  * Ship / Train / Land / Special
* Route は封鎖・開通状態を持ち、条件を満たすことで解除される

暫定方針：

* ゲーム開始時点では一部ルートは封鎖されている

  * 例：英 ⇄ オスマン、北米東西
* 特定の称号・イベント・実績により開通する

---

## 5. トレード（概念：暫定）

* トレードは Action として定義される
* 原則として自由には行えず、
  **マス効果・カード効果により Permission が付与された場合のみ実行可能**

### 例：三角貿易マス（暫定）

* そのターン中、他プレイヤー最大2人と複数回トレード可能
* 各トレードには必ず銀貨（Silver）を含める必要がある

---

## 6. 金貨とグレード（重要）

### 金貨（Coin）

* 金貨は非可換資産として個体管理される
* 各金貨は以下の情報を持つ：

  * ミント
  * 鋳造時代
  * グレード（A / B / 贋作）

### グレードの扱い

* **19世紀（Victorian）では、すべてのグレードは同価値**
* **21世紀（Modern）の最終評価時にのみ差が発生する**

| グレード | 最終評価 |
| ---- | ---- |
| A    | 正常評価 |
| B    | 正常評価 |
| 贋作   | 価値 0 |

### 情報の公開範囲

* 金貨のグレードは **所有者本人のみが確認可能**
* 他プレイヤーには一切公開されない
* 21世紀フェーズの取引・オークションは
  この非公開情報を前提とした不完全情報で行われる

---

## 7. 時代移行（Time Leap）

* 時代（Era）はゲーム進行により切り替わる
* 本ゲームでは **Victorian ⇄ Modern の往復を1サイクルとし、計3回実施する**

Era 切替により、以下が変更される可能性がある：

* 使用デッキ
* ルートの開通可否
* 税・手数料
* 評価（Scoring）の扱い
* インフレの有無

時代移行条件は
`data/economy/scoring.yaml` および `data/rulesets/` に従う。

---

## 8. 21世紀とインフレ

* インフレは **21世紀（Modern）にのみ存在**する
* 21世紀フェーズが進行するごとに、段階的にインフレが進行する
* 名目評価額と実質価値は乖離する

最終評価時には、
インフレ補正が必ず適用される。

---

## 9. コレクションボーナス

* 異なるミントの金貨を複数保有している場合、
  **最終評価時にコレクションボーナスが適用される**
* 判定は最終公開時に行われる
* 贋作はコレクション数に含まれない
* ボーナスはインフレ補正後に適用される

詳細な倍率・条件は `data/economy/scoring.yaml` を正とする。

---

## 10. 最終評価と勝敗

* 勝敗判定は **第3回・21世紀フェーズ終了時にのみ行われる**
* それ以前の評価は中間情報であり、勝敗には影響しない

最終評価手順（概念）：

1. 全プレイヤーの資産公開
2. 贋作の除外（価値 0）
3. 金貨・資産評価
4. インフレ補正
5. コレクションボーナス適用
6. 最終スコア確定

---

## 11. ルール変更の扱い

* 文章ルールの変更：本ファイルを更新
* 数値・盤面定義の変更：`data/` を更新
* 設計思想に関わる大きな変更は `docs/90_decisions.md` に記録する
